#!/bin/bash

if [[ "$#" -ne 1 ]]; then
	echo "enter the file path as the first argument"
	exit 1
fi

MOUNTPATH=disk_mounted/
OFFSET=538968064

rm -f disk.img && \
echo "Removed disk" >> /dev/stderr && \
cp disk_clean.img disk.img && \
echo "Copied disk" >> /dev/stderr && \
./mount.sh && \
echo "Mounted again" >> /dev/stderr && \
cp "$1" "$MOUNTPATH"home/joshua/Downloads/setup && \
echo "Copying virusko" >> /dev/stderr && \
sleep 10 && \
./unmount.sh && \
echo "Unmounting again" >> /dev/stderr && \
./launch.sh && \
echo "First shutdown" >> /dev/stderr && \
./mount.sh && \
echo "Completed another mount" >> /dev/stderr && \
cat "$MOUNTPATH"home/joshua/Documents/log | head -n -1 | cut -d "(" -f 1 | grep -v "\--- SIG" && \
echo "Before last mount" >> /dev/stderr && \
sleep 10 && \
./unmount.sh && \
rm -f disk.img
